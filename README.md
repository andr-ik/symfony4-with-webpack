Demo symfony4 + webpack
===

Пример конфигурации сборки фронтенда для симфони 4

Технологии
---

- yarn
- composer
- symfony
- webpack

Сборка
---

Для сборки понадобится менеджер пакетов для node - yarn ( composer в мире javascript )

Поддерживаются следующие команды:

- `make webpack_dev` - для запуска вебпака в режиме watch с локальным сервером по адресу `localhost:9000`, который следит за изменениями в файлах, пересобирает фронтенд и перезагружает страницу;
- `make webpack_build` - собирает фронтенд один раз для продакшн окружения;
- `make webpack_build_profile` - создает файл profile.json для дебага зависимостей, далее profile.json файл нужно загрузить на сайте `https://webpack.github.io/analyse/` для анализа;

На данный момент поддерживается сборка следующих файлов:

- `js`: все js проходят через babel и на выходе получаются в старом js, который поддерживают все браузеры. На проде минифицируется при помощи uglifyJs
- `css`: поддерживается как scss, так и css
- `images` и `fonts` просто копируются в папку сборки

Flow работы
---

- Запускается `make webpack_dev` для локальной разработки
- Делаем изменения в `/assets`
- `Webpack` замечает изменения и создает новую сборку в папке `/public/assets` + `/config/assets.yaml` с описанием собранной статики
- `Webpack` перезагружает странницу
- `Symfony` читает файл `/config/assets.yaml` и подгружает новые собранные файлы
- Мы видим изменения на стр автоматически

TODO
---

- `Webpack` умеет при сборке css не перезагружать стр целиком, а применять измененные стили на лету ( без перезагрузки стр )
- Не решен вопрос с деплоем полученной сборки на `prod`
- Хотелось бы прокидывать хост для локальной разработки в `pow`
- На данный момент версия в файле `/config/assets.yaml` одинакова для всех файлов и является версией сборки, было бы правильнее рассчитывать версию для каждого собранного файла индивидуально
- Версия в файле `/config/assets.yaml` передается в параметре `?v=[hash]`, правильнее использовать отдельную директорию для сборки, например `/public/assets/d4ab4c/`
- Отрефакторить файл конфигурации вебпака